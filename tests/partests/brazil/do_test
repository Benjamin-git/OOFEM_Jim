# determine oofem version to use
if [ -f ../../../bin/Debug/oofem ]
then
OOFEM=../../../bin/Debug/oofem
elif [ -f  ../../../bin/Release/oofem ]
then  
OOFEM=../../../bin/Release/oofem
else
echo "oofem executable not found" >> ../result
fi

# determine poofem version to use
if [ -f ../../../bin/Debug/poofem ]
then
POOFEM=../../../bin/Debug/poofem
elif [ -f  ../../../bin/Release/poofem ]
then  
POOFEM=../../../bin/Release/poofem
else
echo "poofem executable not found" >> ../result
fi

ln -s $OOFEM  ./oofem
ln -s $POOFEM ./poofem

./oofem -f brazil_2d_nl.oofem.in
../../../tools/checker -f brazil_2d_nl.oofem.in >> ../result
mpirun -np 2 ./poofem -f brazil_2d_nl2.oofem.in -ksp_rtol 1.e-15 -ksp_type cg
for i in brazil_2d_nl2.oofem.in??; do ../../../tools/checker -f $i; done >> ../result
mpirun -np 4 ./poofem -f brazil_2d_nl4.oofem.in -ksp_rtol 1.e-15 -ksp_type cg
for i in brazil_2d_nl4.oofem.in??; do ../../../tools/checker -f $i; done >> ../result
mpirun -np 7 ./poofem -f brazil_2d_nl7.oofem.in -ksp_rtol 1.e-15 -ksp_type cg
for i in brazil_2d_nl7.oofem.in??; do ../../../tools/checker -f $i; done >> ../result

rm *.oofem.out
rm *.oofem.out.*

rm oofem
rm poofem